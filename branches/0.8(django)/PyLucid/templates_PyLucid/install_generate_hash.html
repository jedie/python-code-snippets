{% extends "install_base.html" %}

{% block head %}
<script type="text/javascript" src="/{{ media_prefix }}/sha1.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
if (!document.getElementById) {
    alert("Your Browser is not supported!");
}
function make_salt() {
    /* return a random four digit number */
    salt = Math.random();
    salt = salt*10000;
    salt = Math.round(salt);
    return salt
}
function make_hash() {
    source = document.getElementById("source").value;

    if (source.length<8) {
        alert("Password min len 8! - current len:" + source.length);
        return false;
    }

    for (var i = 1; i <= source.length; i++) {
       unicode_charcode = source.charCodeAt(i);
       if (unicode_charcode > 127) {
            alert("Only ASCII letters are allowed!");
            return false;
       }
    }

    salt = make_salt();
    sha = hex_sha1(salt + source)
    hash = "sha$" + salt + "$" + sha
    document.getElementById("hash").value = hash;
    document.getElementById("source").value = "";
}
/* ]]> */
</script>
<style type="text/css">
/* <![CDATA[ */
.help_text {
    font-size:0.8em;
}
#hash {
    background-color: grey;
}
/* ]]> */
</style>
{% endblock %}

{% block content %}
<h1>{% trans 'Generate _install section password hash.' %}</h1>
<p>
{% trans 'Here you can generate a password hash for the _install section access.' %}
</p>
<noscript>
    <p><strong>{% trans 'JavaScript is needed!' %}</strong></p>
</noscript>

<fieldset>
    <legend>{% trans 'Generate password hash.' %}</legend>
    <p>
    <label for="source">Input your Password here :</label>
    <input id="source" type="text" name="{% trans 'Password' %}" size="20" onchange="make_hash();" /><br />
    <span class="help_text">{% trans '(min. 8 chars long; only ASCII letters are allowed!)' %}</span>
    </p>
    <p>
    <label for="hash">generated SHA-1 hash :</label>
    <input id="hash" type="text" value="(input password first)" size="49" maxlength="49" readonly="readonly" /><br />
    <span class="help_text">{% trans 'You must copy/paste the hash into your settings.py file.' %}</span>
    </p>
    <input type="button" value="make hash" onclick="make_hash();"><br />
</fieldset>

<p>
<strong>{% trans 'Info:' %}</strong><br />
{% trans 'The password would be hased with a JavaScript in your Browser. It will not send to the server back!' %}
</p>
{% endblock %}